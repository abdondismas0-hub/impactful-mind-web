{% extends "base.html" %}

{% block content %}
<div style="padding-top: 50px;">
    
    <!-- 1. Header -->
    <div class="glass-panel" style="text-align: center; margin-bottom: 30px;">
        <h1 style="color: var(--accent);"><i class="fas fa-tachometer-alt"></i> Admin Dashboard</h1>
    </div>
    
    <!-- 2. ANALYTICS (Takwimu Mpya) -->
    <div style="display: flex; gap: 20px; flex-wrap: wrap; margin-bottom: 40px; justify-content: center;">
        <!-- Wageni -->
        <div class="glass-panel" style="flex: 1 1 200px; text-align: center; border-bottom: 4px solid #2ecc71;">
            <h2 style="font-size: 3rem; margin: 0; color: #fff;">{{ total_visitors }}</h2>
            <p>Wageni (Visits)</p>
        </div>
        <div class="glass-panel" style="flex: 1 1 200px; text-align: center; border-bottom: 4px solid #3498db;">
            <h2 style="font-size: 3rem; margin: 0; color: #fff;">{{ total_books }}</h2>
            <p>Vitabu</p>
        </div>
        <div class="glass-panel" style="flex: 1 1 200px; text-align: center; border-bottom: 4px solid #f1c40f;">
            <h2 style="font-size: 3rem; margin: 0; color: #fff;">{{ total_posts }}</h2>
            <p>Posts</p>
        </div>
        <div class="glass-panel" style="flex: 1 1 200px; text-align: center; border-bottom: 4px solid #9b59b6;">
            <h2 style="font-size: 3rem; margin: 0; color: #fff;">{{ total_videos }}</h2>
            <p>Videos</p>
        </div>
    </div>

    <!-- 3. Actions -->
    <h3 style="color: var(--accent); text-align: center; margin-bottom: 20px;">Ongeza Maudhui</h3>
    <div style="display: flex; flex-wrap: wrap; gap: 15px; justify-content: center; margin-bottom: 50px;">
        <a href="{{ url_for('add_book') }}" class="btn" style="background: #3498db;">+ Kitabu</a>
        <a href="{{ url_for('add_post') }}" class="btn" style="background: #f1c40f; color: #000;">+ Post</a>
        <a href="{{ url_for('add_video') }}" class="btn" style="background: #9b59b6;">+ Video</a>
        <a href="{{ url_for('edit_about') }}" class="btn" style="background: #e67e22;">Hariri Founder</a>
    </div>

    <!-- 4. MANAGE CONTENT -->
    
    <!-- Manage Posts -->
    <div class="glass-panel">
        <h3 style="color: var(--accent); border-bottom: 1px solid rgba(255,255,255,0.1); padding-bottom: 10px;">Simamia Posts</h3>
        {% if posts %}
        <div class="admin-table-container">
            <table class="admin-table">
                <thead><tr><th>Kichwa</th><th>Tarehe</th><th>Tendo</th></tr></thead>
                <tbody>
                    {% for post in posts %}
                    <tr>
                        <td>{{ post.title }}</td>
                        <td>{{ post.date_posted.strftime('%d/%m/%Y') }}</td>
                        <td>
                            <form action="{{ url_for('delete_post', id=post.id) }}" method="POST" onsubmit="return confirm('Futa Post Hii?');">
                                <button type="submit" class="btn btn-danger" style="padding: 5px 10px; font-size: 0.8rem;">Futa</button>
                            </form>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        {% else %}
        <p style="color: #888;">Hakuna posts.</p>
        {% endif %}
    </div>

    <!-- Manage Books -->
    <div class="glass-panel">
        <h3 style="color: var(--accent); border-bottom: 1px solid rgba(255,255,255,0.1); padding-bottom: 10px;">Simamia Vitabu</h3>
        {% if books %}
        <div class="admin-table-container">
            <table class="admin-table">
                <thead><tr><th>Jina</th><th>Mwandishi</th><th>Tendo</th></tr></thead>
                <tbody>
                    {% for book in books %}
                    <tr>
                        <td>{{ book.title }}</td>
                        <td>{{ book.author }}</td>
                        <td>
                            <form action="{{ url_for('delete_book', id=book.id) }}" method="POST" onsubmit="return confirm('Futa Kitabu Hiki?');">
                                <button type="submit" class="btn btn-danger" style="padding: 5px 10px; font-size: 0.8rem;">Futa</button>
                            </form>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        {% else %}
        <p style="color: #888;">Hakuna vitabu.</p>
        {% endif %}
    </div>

    <!-- MPYA: Manage Videos -->
    <div class="glass-panel">
        <h3 style="color: var(--accent); border-bottom: 1px solid rgba(255,255,255,0.1); padding-bottom: 10px;">Simamia Video</h3>
        {% if videos %}
        <div class="admin-table-container">
            <table class="admin-table">
                <thead><tr><th>Kichwa</th><th>Tarehe</th><th>Tendo</th></tr></thead>
                <tbody>
                    {% for video in videos %}
                    <tr>
                        <td>{{ video.title }}</td>
                        <td>{{ video.date_uploaded.strftime('%d/%m/%Y') }}</td>
                        <td>
                            <form action="{{ url_for('delete_video', id=video.id) }}" method="POST" onsubmit="return confirm('Futa Video Hii?');">
                                <button type="submit" class="btn btn-danger" style="padding: 5px 10px; font-size: 0.8rem;">Futa</button>
                            </form>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        {% else %}
        <p style="color: #888;">Hakuna video.</p>
        {% endif %}
    </div>

    <!-- Logout -->
    <div style="text-align: center; margin-top: 40px; margin-bottom: 50px;">
        <a href="{{ url_for('admin_logout') }}" class="btn" style="background-color: transparent; border: 1px solid var(--danger); color: var(--danger);">
            <i class="fas fa-sign-out-alt"></i> Ondoka (Logout)
        </a>
    </div>

</div>
{% endblock %}


                           
