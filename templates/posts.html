{% extends "base.html" %}

{% block content %}
<div style="padding-top: 20px;">
    <div class="glass-panel" style="text-align: center; margin-bottom: 40px;">
        <h1 style="color: var(--accent); font-size: 2.5rem;">Daily Posts</h1>
        <p style="color: #ccc;">Maarifa mapya kila siku.</p>
    </div>

    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); gap: 30px;">
        {% for post in posts %}
        <div class="glass-panel" style="padding: 0; overflow: hidden; display: flex; flex-direction: column;">
            
            <!-- Picha imeboreshwa hapa (post-card-img class) -->
            <div class="post-card-img" style="height: 250px; background: #000; overflow: hidden;">
                {% if post.image_file %}
                    <!-- LOGIC MPYA -->
                    {% set img_src = post.image_file if 'http' in post.image_file else url_for('download_book', filename=post.image_file) %}
                    <img src="{{ img_src }}" alt="{{ post.title }}" style="width: 100%; height: 100%; object-fit: cover;">
                {% else %}
                    <div style="width: 100%; height: 100%; background: linear-gradient(135deg, #2c3e50, #4ca1af); display: flex; align-items: center; justify-content: center;">
                        <i class="fas fa-newspaper fa-3x" style="color: rgba(255,255,255,0.3);"></i>
                    </div>
                {% endif %}
            </div>
            
            <div style="padding: 25px; flex-grow: 1; display: flex; flex-direction: column;">
                <small style="color: var(--accent);"><i class="far fa-calendar-alt"></i> {{ post.date_posted.strftime('%d %B %Y') }}</small>
                <h3 style="color: #fff; margin: 10px 0; font-size: 1.4rem;">{{ post.title }}</h3>
                <p style="color: #ccc; line-height: 1.6; margin-bottom: 20px; flex-grow: 1;">{{ post.content[:120] }}...</p>
                <a href="{{ url_for('view_post', post_id=post.id) }}" class="btn" style="text-align: center;">Soma Zaidi</a>
            </div>
        </div>
        {% else %}
        <div class="glass-panel" style="grid-column: 1 / -1; text-align: center;">
            <p>Hakuna machapisho bado.</p>
        </div>
        {% endfor %}
    </div>
</div>
{% endblock %}


